// File này dùng Sequelize để kết nối với CSDL MySQL
const { Sequelize } = require('sequelize');

// --- CẤU HÌNH KẾT NỐI ---
// Khởi tạo một kết nối Sequelize
// Hãy thay 'quanlyclb_db', 'root', và 'MatKhauMoi123!' bằng thông tin của bạn
const sequelize = new Sequelize('quanlyclb_db', 'root', 'MatKhauMoi123!', {
  host: 'localhost',
  dialect: 'mysql', // Báo cho Sequelize biết chúng ta đang dùng MySQL
  logging: false // Tắt log SQL cho gọn gàng, bạn có thể bật lại nếu cần
});

// --- HÀM KIỂM TRA KẾT NỐI ---
const testConnection = async () => {
  try {
    // Dùng hàm .authenticate() để kiểm tra thông tin cấu hình
    await sequelize.authenticate();
    console.log('✅ [DATABASE] Kết nối CSDL MySQL thành công!');
  } catch (error) {
    // Báo lỗi chi tiết nếu kết nối thất bại
    console.error('❌ [DATABASE] KHÔNG THỂ KẾT NỐI CSDL:', error);
    // Ném lỗi ra để ứng dụng bên ngoài (như testConnection.js) biết
    throw error; 
  }
};

// --- EXPORT ---
// Xuất (export) sequelize instance và hàm testConnection
module.exports = { sequelize, testConnection };
